// matching.proto

syntax = "proto3";

package dgdo.matching;

import "common.proto";

// --------------------
// Candidate driver
// --------------------

message Candidate {
  string driver_id = 1;
  double probability = 2;   // normalized, sum â‰ˆ 1
}

// --------------------
// Matching request (command)
// --------------------
message MatchingRequest {
  string trip_request_id = 1;      // immutable reference for idempotency
  double origin_lat = 2;           // minimal geo info
  double origin_lon = 3;
  double dest_lat = 4;
  double dest_lon = 5;
  uint32 max_candidates = 6;       // hard cap
  int64 seed = 7;                  // deterministic replay
}

// --------------------
// Matching response
// --------------------
message MatchingResponse {
  repeated Candidate candidates = 1;
  string reason_code = 2;          // e.g., "NO_DRIVERS", empty if OK
}

// --------------------
// Service
// --------------------
service MatchingService {
  rpc GetCandidates(MatchingRequest) returns (MatchingResponse);
}
